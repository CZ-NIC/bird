# Note: 
# If you change a dockerfile as a first commit on a new branch, 
# it will not trigger the image rebuild on a push. 
# For that you need to push another commit. Have fun!

distros:
  # CentOS 7 with quite some hacks
  - name: centos-7-amd64
    variables:
      LC_ALL: en_US.UTF-8
      CC: /opt/rh/devtoolset-8/root/usr/bin/gcc
    type: pkg-rpm-wa
    arch: amd64

  {% for name in (
    'centos-8',
    'rocky-08',
    'rocky-09',
    'oracle-08',
    'oracle-09',
    'oracle-10',
    'fedora-32',
    'fedora-33',
  ) -%}
  - name: {{ name }}-amd64
    type: pkg-rpm-wa
    arch: amd64
  {% endfor %}

  # For some unknown reason we also require older Python packages
  # for OpenSUSE even with the recent versions.
  {% for num in (0,1,2,3,4,5) -%}
  - name: opensuse-15.{{ num }}-amd64
    type: pkg-rpm-wa
    arch: amd64
  {% endfor %}

  # Fedora regular builds
  {% for num in (34, 35, 36, 37, 38, 39, 40, 41, 42, 43) -%}
  - name: fedora-{{ num }}-amd64
    type: pkg-rpm
    arch: amd64
  {% endfor %}

  # Old Debian-based builds
  {% for distro in ("ubuntu-18.04", "ubuntu-20.04") %}
  - name: {{ distro }}-amd64
    type: pkg-deb
    arch: amd64
  {% endfor %}

  {% for arch in ('amd64', 'i386') %}
  - name: debian-11-{{ arch }}
    type: pkg-deb
    arch: {{ arch }}
  {% endfor %}

  # Debian regular builds
  {% for arch in ('amd64', 'i386', 'arm64', 'armel', 'armhf', 'mips64el', 's390x') %}
  - name: debian-12-{{ arch }}
    code: bookworm
    type: pkg-deb
    arch: {{ arch }}
    mirror: "http://deb.debian.org/debian"
    components: main
  {% endfor %}

  {% for arch in ('amd64', 'i386', 'arm64', 'armel', 'armhf', 'riscv64', 's390x') -%}
  - name: debian-13-{{ arch }}
    code: trixie
    type: pkg-deb
    arch: {{ arch }}
    mirror: "http://deb.debian.org/debian"
    components: main
  {% endfor %}

  {% for arch in ('amd64', 'i386', 'arm64', 'armhf', 'riscv64', 's390x') -%}
  - name: debian-testing-{{arch}}
    code: testing
    type: pkg-deb
    arch: {{ arch }}
    mirror: "http://deb.debian.org/debian"
    components: main
  {% endfor %}

  # Ubuntu regular builds
  {% for num,code in (('22.04', 'jammy'), ('24.04', 'noble'), ('25.04', 'plucky'), ('25.10', 'questing')) -%}
  {% for arch in ('amd64', 'arm64', 'armhf', 'ppc64el', 'riscv64', 's390x') -%}
  - name: ubuntu-{{ num }}-{{ arch }}
    type: pkg-deb
    arch: {{ arch }}
    code: {{ code }}
    mirror: "http://ports.ubuntu.com/ubuntu-ports/"
    components: main restricted universe multiverse
  {% endfor %}
  {% endfor %}

birdlab:
  - name: openbsd-75
    variables:
      AUTOCONF_VERSION: "2.71"

  - name: openbsd-76
    variables:
      AUTOCONF_VERSION: "2.72"

  {% for num in ("09", "10") -%}
  - name: netbsd-{{ num }}
  {% endfor %}

  {% for num in (13, 14) -%}
  - name: freebsd-{{ num }}
  - name: freebsd-{{ num }}-netlink
    dist: freebsd-{{ num }}
    variables:
      CONFIGURE_OPTIONS: --with-sysconfig=bsd-netlink --disable-client
  {% endfor %}

partial_build_image:
  name: debian-12-amd64

partial_build:
  - protocols: aggregator
  - protocols: babel
  - protocols: bfd
  - protocols: bgp
  - protocols: bgp,bmp
  - protocols: l3vpn
  - protocols: mrt
  - protocols: ospf
  - protocols: pipe
  - protocols: radv
  - protocols: rip
  - protocols: rpki
  - protocols: static

netlab:
  - name: babel-base
  - name: babel-auth
  - name: ospf-base
  - name: ospf-default
  - name: ospf-priority
  - name: ospf-nbma
  - name: ospf-ptmp
  - name: ospf-authentication
  - name: ospf-bfd
  - name: ospf-custom
  - name: ospf-area
  - name: ospf-vrf
  - name: bgp-base
  - name: bgp-auth
  - name: bgp-int
  - name: bgp-merged
  - name: bgp-flowspec
  - name: bgp-rs-multitab
  - name: bgp-rs-singletab
  - name: ebgp-graceful
  - name: ebgp-loop
  - name: ebgp-star
  - name: ebgp-role
  - name: ebgp-import-limit
  - name: ebgp-hostname
  - name: ibgp-loop
  - name: ibgp-loop-big
  - name: ibgp-flat
  - name: rip-base
  - name: kernel-learn
  - name: mpls-bgp
  - name: mpls-bgp-l3vpn
